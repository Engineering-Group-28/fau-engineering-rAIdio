<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FAU Engineering rAIdio Station â€” Sign Up</title>
  <style>
    h1 {
  font-family: 'Lexend', sans-serif; 
  color: #292A2B; 
  margin-bottom: 10px; 
  line-height: 1.5; 
  font-size: 60px;
  text-align: center;
}

p  {
  font-family: 'Lexend', 
  sans-serif; color: #292A2B; 
  margin-bottom: 10px; 
  line-height: 1.5; 
  padding: 10px 10px 10px 10px;
  }

body {
  margin: 0; 
  padding: 0; 
  height: 100%;
  background-image: url('images/background_idea.png');
  background-color: #ffffff; /* Fallback color */
  background-repeat: no-repeat; /* Prevents image from repeating */
  background-size: cover; /* Scales image to cover the entire background */
  background-attachment: fixed;
  }

html {background-color: #FFFFFF; margin: 0; padding: 0; height: 100%;}

.topnav {
  display: flex;
  align-items: center;
  height: 8%;
  text-decoration: none;
  font-family: 'Lexend', sans-serif;
  font-weight: 400;
  column-gap: 20px;
  overflow: hidden;
  margin: 0;
  padding: 0px 60px 0px 60px;
  background-image: linear-gradient(to right, #003366, #45B0DE, #DE3347);
}

.topnav a {
  display: block;
  text-decoration: none;
  color: #FFFFFF;
  font-weight: bold;
  padding: 14px 16px;
  font-family: 'Lexend', sans-serif;
  font-size: 17px;
  font-weight: 400;
}

.topnav a:hover {
  text-decoration: underline;
  text-underline-offset: 10px;
  color: white;
}

.topnav a.active {
  text-decoration: underline;
  text-underline-offset: 10px;
  color: #FFFFFF;
}

.topnav input[type=search] {
  margin-left: auto;
  padding: 6px;
  border: none;
  margin-top: 4px;
  margin-right: 16px;
  font-size: 14px;
  border-radius: 2px;
}

    .container {
      max-width: 600px;
      margin: 50px auto;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    h1 {
      text-align: center;
      color: #292A2B;
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    label {
      font-weight: bold;
    }

    input {
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    button {
      padding: 10px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      background-color: #003366;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background-color: #45B0DE;
    }

    .success {
      color: #0a7a2f;
      margin-top: 10px;
      font-weight: 600;
    }

    .error {
      color: #b00020;
      margin-top: 10px;
    }

    .logo {
    height: 75%;
    }
</style>
</head>
<body>
  <div class="topnav">
    <img class="logo" src="images/owl_radio_nav.png" alt="Engineering rAIdio">
    <a href="home.html">Home</a>
    <a href="rAIdio.html">rAIdio</a>
    <a href="podcasts.html">Podcasts</a>
    <a href="feedback.html">Feedback</a>
    <a href="about.html">About</a>
    <a href="login.html">Login</a>
  </div>

  <div class="container">
    <h1>Sign Up</h1>
    <form id="signupForm">
      <label for="name">Name:</label>
      <input type="text" id="name" name="name" placeholder="Enter your name" required>

      <label for="studentId">Student ID:</label>
      <input type="text" id="studentId" name="studentId" placeholder="Enter your student ID" required>

      <label for="email">Email:</label>
      <input type="email" id="email" name="email" placeholder="Enter your email" required>

      <label for="phone">Phone Number:</label>
      <input type="text" id="phone" name="phone" placeholder="Enter your phone number">

      <label for="password">Password:</label>
      <input type="password" id="password" name="password" placeholder="Create a password" required>

      <button type="submit">Sign Up</button>
      <div id="formMsg" aria-live="polite"></div>
    </form>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const SUPABASE_URL = "https://vefipiufdaxfllfwtavs.supabase.co";
  const SUPABASE_ANON = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZlZmlwaXVmZGF4ZmxsZnd0YXZzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTczMDAyNTQsImV4cCI6MjA3Mjg3NjI1NH0.evvilDK6acch5X3IKyWZUyiwSUtlWg1s97zOaFUKXCs"; // keep your anon key
  const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON);
  

  const form = document.getElementById('signupForm');
  const formMsg = document.getElementById('formMsg');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const name = form.elements['name'].value.trim();
    const studentId = form.elements['studentId'].value.trim();
    const email = form.elements['email'].value.trim();
    const phone = form.elements['phone'].value.trim();
    const password = form.elements['password'].value.trim();

    try {
      // 1) Create user in Supabase Auth
      const { data: authData, error: authError } = await supabase.auth.signUp({
        email,
        password,
      });

      if (authError) {
        console.error("Auth Error:", authError);
        formMsg.className = "error";
        formMsg.textContent = authError.message;
        return;
      }

      // 2) Insert profile (non-blocking)
      if (authData.user) {
        const { error: profileError } = await supabase.from("profiles").insert([{
          id: authData.user.id,
          name,
          student_id: studentId,
          email,
          phone,
        }]);

        if (profileError) {
          console.warn("Profile insert failed:", profileError.message);
          // still let user proceed
        }
      }

      // 3) Success message
      formMsg.className = "success";
      formMsg.textContent = "Sign up successful! Please check your email to confirm your account.";
      // optional redirect:
      // setTimeout(() => window.location.href = "login.html", 2000);

    } catch (err) {
      console.error("Unexpected Error:", err);
      formMsg.className = "error";
      formMsg.textContent = "Unexpected error. See console for details.";
    }
  });
</script>
</body>
</html>